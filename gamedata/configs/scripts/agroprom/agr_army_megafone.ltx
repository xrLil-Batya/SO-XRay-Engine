[logic]
active = {+agr_megafone_broken} nil, ph_idle@wait

[ph_idle@wait]
on_info = %=play_sound(agr_army_comandir_megafon)%
on_info2 = {=is_night} ph_idle@night, {=check_smart_alarm_status(agr_army_base_b)} ph_idle@alarm %=stop_sound%
on_info3 = {=is_night} ph_idle@night, {=check_smart_alarm_status(agr_army_base_c)} ph_idle@alarm %=stop_sound%
hit_on_bone = 2|ph_idle@broken

[ph_idle@night]
on_info = %=stop_sound%
on_info2 = {!is_night} ph_idle@wait, {=check_smart_alarm_status(agr_army_base_b)} ph_idle@alarm %=stop_sound%
on_info3 = {!is_night} ph_idle@wait, {=check_smart_alarm_status(agr_army_base_c)} ph_idle@alarm %=stop_sound%
hit_on_bone = 2|ph_idle@broken

[ph_idle@alarm]
on_info = %=play_sound(agr_army_alarm)%
on_info2 = {=is_night !check_smart_alarm_status(agr_army_base_b)} ph_idle@night, {!check_smart_alarm_status(agr_army_base_b)} ph_idle@wait
on_info3 = {=is_night !check_smart_alarm_status(agr_army_base_c)} ph_idle@night, {!check_smart_alarm_status(agr_army_base_c)} ph_idle@wait
hit_on_bone = 2|ph_idle@broken

[ph_idle@broken]
on_info = nil %=stop_sound +agr_megafone_broken%